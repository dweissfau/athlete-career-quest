{"version":3,"sources":["app/scoring.cljc"],"mappings":"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","names":["app.scoring/default-dimension-weights","app.scoring/default-category-weights","app.scoring/get-config-value","config","key","default","or__5045__auto__","G__45398","p1__45396#","cljs.core.filter","cljs.core._EQ_","cljs.core/first","app.scoring/normalize-response","response","question","value","q-type","G__45402","ranks","cljs.core/seq","cljs.core.reduce","cljs.core/+","cljs.core.map_indexed","i","_","cljs.core/count","app.scoring/calculate-dimension-scores","responses","questions","response-map","cljs.core.into","cljs.core.map","r","question-map","q","scores","cljs.core.get","weights","normalized","p__45409","vec__45410","cljs.core.nth","s","dimension","weight","dim-key","cljs.core.keyword","cljs.core.update","p__45413","map__45414","cljs.core/--destructure-map","total","count","app.scoring/finalize-dimension-scores","raw-scores","dimension-weights","cljs.core/reduce-kv","p__45417","map__45418","dim","avg","cljs.core.assoc","app.scoring/calculate-category-scores","categories","category-map","c","question-categories","cljs.core/group-by","cat-id","cat-questions","category","cat-name","cat-responses","cljs.core/identity","p1__45420#","avg-score","p1__45421#","app.scoring/calculate-career-match","dimension-scores","career","required-dims","match-scores","p__45428","vec__45429","importance","user-score","cljs.core/second","app.scoring/calculate-career-scores","careers","cljs.core.sort_by","cljs.core/>","app.scoring/generate-internship-recommendation","career-scores","leadership","communication","urgency","top-careers","cljs.core.take","avg-internship-importance","x__5133__auto__","y__5134__auto__","app.scoring/generate-major-recommendation","all-majors","cljs.core.mapcat","major-freq","cljs.core/frequencies","ranked-majors","cljs.core/val","p__45440","vec__45441","major","freq","top-score","app.scoring/generate-grad-school-recommendation","education-openness","income-priority","grad-recommended-careers","grad-percentage","x__5130__auto__","y__5131__auto__","explicit-grad-intent","cljs.core.distinct","app.scoring/generate-industry-recommendation","by-category","category-scores","p__45453","vec__45454","cat","app.scoring/generate-roadmap","internship-rec","major-rec","grad-school-rec","industry-rec","cljs.core.get_in","clojure.string.join","app.scoring/calculate-results","category-weights","raw-dimension-scores","roadmap"],"sourcesContent":["(ns app.scoring\n  \"Scoring algorithm for career recommendations\"\n  (:require [clojure.string :as str]))\n\n;; Default dimension weights (20 dimensions)\n;; Core dimensions (14):\n;;   people, data, creative, analytical, leadership, communication,\n;;   technical, physical, competitive, collaborative, risk-tolerance,\n;;   income-priority, education-openness, urgency\n;; Extended dimensions (6):\n;;   sports-connection, negotiation, mentoring, entrepreneurial,\n;;   pressure-tolerance, social-impact\n(def default-dimension-weights\n  {:people 1.0\n   :data 1.0\n   :creative 1.0\n   :analytical 1.0\n   :leadership 1.2\n   :communication 1.1\n   :technical 1.0\n   :physical 0.8\n   :competitive 1.0\n   :collaborative 1.0\n   :risk-tolerance 1.0\n   :income-priority 1.0\n   :education-openness 1.0\n   :urgency 1.0\n   ;; Extended dimensions for athlete career matching\n   :sports-connection 1.0\n   :negotiation 1.0\n   :mentoring 1.0\n   :entrepreneurial 1.0\n   :pressure-tolerance 1.0\n   :social-impact 1.0})\n\n;; Default category weights\n(def default-category-weights\n  {:interests 0.25\n   :skills 0.30\n   :financial 0.20\n   :timeline 0.25})\n\n(defn get-config-value\n  \"Get configuration value with fallback\"\n  [config key default]\n  (or (some-> (filter #(= (:config-key %) key) config)\n              first\n              :config-value)\n      default))\n\n(defn normalize-response\n  \"Normalize a response value to 0-1 scale\"\n  [response question]\n  (let [value (:response-value response)\n        q-type (:question-type question)]\n    (case q-type\n      \"likert\" (/ (dec (or (:value value) value 3)) 4.0)  ; 1-5 scale\n      \"multiple_choice\" (or (:score value) 0.5)\n      \"ranking\" (let [ranks (:ranks value)]\n                  (if (seq ranks)\n                    (/ (reduce + (map-indexed (fn [i _] (/ (- (count ranks) i) (count ranks))) ranks))\n                       (count ranks))\n                    0.5))\n      \"scenario\" (or (:score value) 0.5)\n      \"short_text\" 0.5  ; Text responses don't contribute to scoring directly\n      0.5)))\n\n(defn calculate-dimension-scores\n  \"Calculate scores for each dimension based on responses\"\n  [responses questions]\n  (let [response-map (into {} (map (fn [r] [(:question-id r) r]) responses))\n        question-map (into {} (map (fn [q] [(:id q) q]) questions))]\n    (reduce\n      (fn [scores response]\n        (let [question (get question-map (:question-id response))\n              weights (:scoring-weights question)\n              normalized (normalize-response response question)]\n          (reduce\n            (fn [s [dimension weight]]\n              (let [dim-key (keyword dimension)]\n                (update s dim-key\n                        (fn [{:keys [total count] :or {total 0 count 0}}]\n                          {:total (+ total (* normalized weight))\n                           :count (inc count)}))))\n            scores\n            weights)))\n      {}\n      responses)))\n\n(defn finalize-dimension-scores\n  \"Convert accumulated scores to final 0-1 scores\"\n  [raw-scores dimension-weights]\n  (reduce-kv\n    (fn [scores dim {:keys [total count]}]\n      (let [avg (if (pos? count) (/ total count) 0.5)\n            weight (get dimension-weights dim 1.0)]\n        (assoc scores dim (* avg weight))))\n    {}\n    raw-scores))\n\n(defn calculate-category-scores\n  \"Calculate scores by category\"\n  [responses questions categories]\n  (let [category-map (into {} (map (fn [c] [(:id c) c]) categories))\n        question-categories (group-by :category-id questions)\n        response-map (into {} (map (fn [r] [(:question-id r) r]) responses))]\n    (reduce-kv\n      (fn [scores cat-id cat-questions]\n        (let [category (get category-map cat-id)\n              cat-name (keyword (:name category))\n              cat-responses (filter identity\n                                    (map #(get response-map (:id %)) cat-questions))\n              avg-score (if (seq cat-responses)\n                          (/ (reduce + (map #(normalize-response %\n                                               (first (filter (fn [q] (= (:id q) (:question-id %)))\n                                                              cat-questions)))\n                                            cat-responses))\n                             (count cat-responses))\n                          0.5)]\n          (assoc scores cat-name avg-score)))\n      {}\n      question-categories)))\n\n(defn calculate-career-match\n  \"Calculate match score between user profile and a career\"\n  [dimension-scores career]\n  (let [required-dims (:required-dimensions career)\n        match-scores (map\n                       (fn [[dim importance]]\n                         (let [user-score (get dimension-scores (keyword dim) 0.5)]\n                           (* user-score importance)))\n                       required-dims)]\n    (if (seq match-scores)\n      (/ (reduce + match-scores) (reduce + (map second required-dims)))\n      0.5)))\n\n(defn calculate-career-scores\n  \"Calculate match scores for all careers\"\n  [dimension-scores careers]\n  (->> careers\n       (map (fn [career]\n              {:career-id (:id career)\n               :career-name (:name career)\n               :career-category (:category career)\n               :match-score (calculate-career-match dimension-scores career)\n               :grad-school-recommended (:grad-school-recommended career)\n               :internship-importance (:internship-importance career)\n               :typical-majors (:typical-majors career)\n               :salary-range (:salary-range career)}))\n       (sort-by :match-score >)))\n\n(defn generate-internship-recommendation\n  \"Generate internship recommendation based on scores\"\n  [dimension-scores career-scores]\n  (let [leadership (get dimension-scores :leadership 0.5)\n        communication (get dimension-scores :communication 0.5)\n        urgency (get dimension-scores :urgency 0.5)\n        top-careers (take 3 career-scores)\n        avg-internship-importance (/ (reduce + (map :internship-importance top-careers)) 3)]\n    {:recommended (> avg-internship-importance 3)\n     :confidence (min 1.0 (* (+ leadership communication) 0.5))\n     :reasoning (cond\n                  (and (> leadership 0.7) (> communication 0.7))\n                  \"Strong leadership and communication skills make you well-suited for competitive internship programs.\"\n                  (> urgency 0.7)\n                  \"Your desire to gain practical experience early makes internships highly valuable.\"\n                  :else\n                  \"Internships will help you explore career options and build professional skills.\")\n     :suggested-types (map :career-category (take 3 career-scores))}))\n\n(defn generate-major-recommendation\n  \"Generate major recommendations based on career matches\"\n  [career-scores]\n  (let [top-careers (take 5 career-scores)\n        all-majors (mapcat :typical-majors top-careers)\n        major-freq (frequencies all-majors)\n        ranked-majors (->> major-freq\n                           (sort-by val >)\n                           (take 3)\n                           (map (fn [[major freq]]\n                                  {:name major\n                                   :fit (/ freq (count top-careers))})))]\n    {:top-3 ranked-majors\n     :confidence (let [top-score (:match-score (first top-careers))]\n                   (if top-score (min 1.0 (* top-score 1.1)) 0.5))}))\n\n(defn generate-grad-school-recommendation\n  \"Generate grad school recommendation based on scores and careers\"\n  [dimension-scores career-scores]\n  (let [education-openness (get dimension-scores :education-openness 0.5)\n        income-priority (get dimension-scores :income-priority 0.5)\n        urgency (get dimension-scores :urgency 0.5)\n        top-careers (take 5 career-scores)\n        grad-recommended-careers (filter :grad-school-recommended top-careers)\n        grad-percentage (/ (count grad-recommended-careers) (max 1 (count top-careers)))\n        ;; Low urgency + education openness = explicit grad school intent\n        explicit-grad-intent (and (< urgency 0.25) (> education-openness 0.4))]\n    {:recommended (or explicit-grad-intent\n                      (and (> education-openness 0.5)\n                           (> grad-percentage 0.4)))\n     :confidence (if explicit-grad-intent\n                   (min 1.0 (+ 0.7 (* education-openness 0.3)))\n                   (min 1.0 (* education-openness grad-percentage)))\n     :timing (cond\n               (< urgency 0.25)\n               \"Consider pursuing immediately after undergraduate\"\n               (and (> income-priority 0.7) (< urgency 0.3))\n               \"Consider pursuing immediately after undergraduate\"\n               (> urgency 0.5)\n               \"After 2-3 years of work experience\"\n               :else\n               \"After 3-5 years of work experience\")\n     :suggested-programs (distinct (mapcat :typical-majors grad-recommended-careers))}))\n\n(defn generate-industry-recommendation\n  \"Generate top industry recommendations\"\n  [career-scores]\n  (let [by-category (group-by :career-category career-scores)\n        category-scores (->> by-category\n                             (map (fn [[cat careers]]\n                                    {:name cat\n                                     :fit (/ (reduce + (map :match-score careers))\n                                             (count careers))}))\n                             (sort-by :fit >)\n                             (take 3))]\n    {:top-3 category-scores\n     :confidence (:fit (first category-scores))}))\n\n(defn generate-roadmap\n  \"Generate career roadmap based on recommendations\"\n  [internship-rec major-rec grad-school-rec industry-rec]\n  [{:phase \"Now\"\n    :actions [(if (:recommended internship-rec)\n                \"Begin researching internship opportunities\"\n                \"Focus on building relevant skills\")\n              \"Explore recommended majors\"\n              \"Connect with career services\"]}\n   {:phase \"Sophomore Year\"\n    :actions [(when (:recommended internship-rec)\n                \"Secure first internship\")\n              (str \"Declare major: \" (get-in major-rec [:top-3 0 :name]))\n              \"Join relevant student organizations\"]}\n   {:phase \"Junior Year\"\n    :actions [(when (:recommended internship-rec)\n                \"Complete competitive internship\")\n              \"Build professional network in target industry\"\n              \"Begin informational interviews\"]}\n   {:phase \"Senior Year\"\n    :actions [(if (:recommended grad-school-rec)\n                (str \"Apply to graduate programs (\" (:timing grad-school-rec) \")\")\n                \"Apply to entry-level positions\")\n              (str \"Target industries: \" (str/join \", \" (map :name (:top-3 industry-rec))))]}])\n\n(defn calculate-results\n  \"Main entry point: calculate all results from responses\"\n  [responses questions careers config]\n  (let [;; Get configuration\n        category-weights (get-config-value config \"scoring_weights\" default-category-weights)\n        dimension-weights (get-config-value config \"dimension_weights\" default-dimension-weights)\n\n        ;; Calculate dimension scores\n        raw-dimension-scores (calculate-dimension-scores responses questions)\n        dimension-scores (finalize-dimension-scores raw-dimension-scores dimension-weights)\n\n        ;; Calculate category scores (placeholder - would need category data)\n        category-scores {:interests 0.5 :skills 0.5 :financial 0.5 :timeline 0.5}\n\n        ;; Calculate career matches\n        career-scores (calculate-career-scores dimension-scores careers)\n\n        ;; Generate recommendations\n        internship-rec (generate-internship-recommendation dimension-scores career-scores)\n        major-rec (generate-major-recommendation career-scores)\n        grad-school-rec (generate-grad-school-recommendation dimension-scores career-scores)\n        industry-rec (generate-industry-recommendation career-scores)\n        roadmap (generate-roadmap internship-rec major-rec grad-school-rec industry-rec)]\n\n    {:profile {:dimensions dimension-scores}\n\n     :category-scores category-scores\n     :dimension-scores dimension-scores\n     :career-scores (take 10 career-scores)\n\n     :recommendations\n     {:internship internship-rec\n      :major major-rec\n      :grad-school grad-school-rec\n      :industry industry-rec}\n\n     :roadmap roadmap}))\n\n(comment\n  ;; Test scoring\n  (calculate-results\n    [{:question-id \"q1\" :response-value {:value 4}}\n     {:question-id \"q2\" :response-value {:value 5}}]\n    [{:id \"q1\" :question-type \"likert\" :scoring-weights {:leadership 0.8 :communication 0.6}}\n     {:id \"q2\" :question-type \"likert\" :scoring-weights {:analytical 0.9 :technical 0.7}}]\n    [{:id \"c1\" :name \"Sports Marketing\" :category \"sports\"\n      :required-dimensions {:leadership 0.7 :communication 0.8}\n      :grad-school-recommended false\n      :internship-importance 4\n      :typical-majors [\"Marketing\" \"Business\"]}]\n    [])\n  )\n"]}